<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Approve Donation</title>
<style>
  body {
    font-family: Arial;
    background:#e6f0ff;
    text-align:center;
    padding:50px;
    color:#003366;
  }
  .message {
    background:#cce0ff;
    display:inline-block;
    padding:20px;
    border-radius:8px;
    font-size:1.2em;
  }
</style>
</head>
<body>

<div class="message" id="message">JS LOADED</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script>
const supabaseUrl = "https://vzovofazxfwboovwaynh.supabase.co";
const supabaseKey = "sb_publishable_iqHfuWclev_w6l7T1Bnndw_T6N5__YB";

// ✅ CORRECT CLIENT INITIALIZATION
const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

async function approveDonation() {
  const messageEl = document.getElementById('message');
  const txid = new URLSearchParams(window.location.search).get('id');

  if (!txid) {
    messageEl.innerText = "Invalid approval link.";
    return;
  }

  const { error } = await supabaseClient
    .from('donors_sponsor')
    .update({ status: 'approved' })
    .eq('txid', txid);

  if (error) {
    console.error(error);
    messageEl.innerText = "Error approving donation.";
    return;
  }

  messageEl.innerText = "✅ Donation approved successfully.";
}

approveDonation();
</script>

</body>
</html>
